<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spring.web.dao.MequipmentMapper">
    <resultMap id="BaseResultMap" type="com.spring.web.model.Mequipment">
        <!-- WARNING - @mbggenerated This element is automatically generated by 
            MyBatis Generator, do not modify. -->
        <constructor>
            <idArg column="id" javaType="java.lang.Integer" jdbcType="INTEGER" />
            <arg column="user_id" javaType="java.lang.Integer" jdbcType="INTEGER" />
            <arg column="equipment_name" javaType="java.lang.String"
                jdbcType="VARCHAR" />
            <arg column="size" javaType="java.lang.String" jdbcType="VARCHAR" />
            <arg column="process_parameters" javaType="java.lang.String"
                jdbcType="VARCHAR" />
            <arg column="amount" javaType="java.lang.Integer" jdbcType="INTEGER" />
            <arg column="remark" javaType="java.lang.String" jdbcType="VARCHAR" />
        </constructor>
    </resultMap>
    <sql id="Base_Column_List">
        <!-- WARNING - @mbggenerated This element is automatically generated by 
            MyBatis Generator, do not modify. -->
        id, user_id, equipment_name, size, process_parameters, amount, remark
    </sql>
    <select id="selectByPrimaryKey" parameterType="java.lang.Integer"
        resultMap="BaseResultMap">
        <!-- WARNING - @mbggenerated This element is automatically generated by 
            MyBatis Generator, do not modify. -->
        select
        <include refid="Base_Column_List" />
        from mequipment_tbl
        where id = #{id,jdbcType=INTEGER}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
        <!-- WARNING - @mbggenerated This element is automatically generated by 
            MyBatis Generator, do not modify. -->
        delete from mequipment_tbl
        where id = #{id,jdbcType=INTEGER}
    </delete>
    <insert id="insert" parameterType="com.spring.web.model.Mequipment">
        <!-- WARNING - @mbggenerated This element is automatically generated by 
            MyBatis Generator, do not modify. -->
        <selectKey keyProperty="id" order="AFTER" resultType="java.lang.Integer">
            SELECT LAST_INSERT_ID()
        </selectKey>
        insert into mequipment_tbl (user_id, equipment_name, size,
        process_parameters, amount, remark
        )
        values (#{userId,jdbcType=INTEGER}, #{equipmentName,jdbcType=VARCHAR},
        #{size,jdbcType=VARCHAR},
        #{processParameters,jdbcType=VARCHAR}, #{amount,jdbcType=INTEGER}, #{remark,jdbcType=VARCHAR}
        )
    </insert>
    <insert id="insertSelective" parameterType="com.spring.web.model.Mequipment">
        <!-- WARNING - @mbggenerated This element is automatically generated by 
            MyBatis Generator, do not modify. -->
        <selectKey keyProperty="id" order="AFTER" resultType="java.lang.Integer">
            SELECT LAST_INSERT_ID()
        </selectKey>
        insert into mequipment_tbl
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="userId != null">
                user_id,
            </if>
            <if test="equipmentName != null">
                equipment_name,
            </if>
            <if test="size != null">
                size,
            </if>
            <if test="processParameters != null">
                process_parameters,
            </if>
            <if test="amount != null">
                amount,
            </if>
            <if test="remark != null">
                remark,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="userId != null">
                #{userId,jdbcType=INTEGER},
            </if>
            <if test="equipmentName != null">
                #{equipmentName,jdbcType=VARCHAR},
            </if>
            <if test="size != null">
                #{size,jdbcType=VARCHAR},
            </if>
            <if test="processParameters != null">
                #{processParameters,jdbcType=VARCHAR},
            </if>
            <if test="amount != null">
                #{amount,jdbcType=INTEGER},
            </if>
            <if test="remark != null">
                #{remark,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.spring.web.model.Mequipment">
        <!-- WARNING - @mbggenerated This element is automatically generated by 
            MyBatis Generator, do not modify. -->
        update mequipment_tbl
        <set>
            <if test="userId != null">
                user_id = #{userId,jdbcType=INTEGER},
            </if>
            <if test="equipmentName != null">
                equipment_name = #{equipmentName,jdbcType=VARCHAR},
            </if>
            <if test="size != null">
                size = #{size,jdbcType=VARCHAR},
            </if>
            <if test="processParameters != null">
                process_parameters = #{processParameters,jdbcType=VARCHAR},
            </if>
            <if test="amount != null">
                amount = #{amount,jdbcType=INTEGER},
            </if>
            <if test="remark != null">
                remark = #{remark,jdbcType=VARCHAR},
            </if>
        </set>
        where id = #{id,jdbcType=INTEGER}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.spring.web.model.Mequipment">
        <!-- WARNING - @mbggenerated This element is automatically generated by 
            MyBatis Generator, do not modify. -->
        update mequipment_tbl
        set user_id = #{userId,jdbcType=INTEGER},
        equipment_name = #{equipmentName,jdbcType=VARCHAR},
        size = #{size,jdbcType=VARCHAR},
        process_parameters = #{processParameters,jdbcType=VARCHAR},
        amount = #{amount,jdbcType=INTEGER},
        remark = #{remark,jdbcType=VARCHAR}
        where id = #{id,jdbcType=INTEGER}
    </update>

    <insert id="insertBatch" parameterType="java.util.Map">
        insert into mequipment_tbl
        (user_id,equipment_name,size,process_parameters,amount,remark)
        values
        <foreach close="" collection="list" index="" item="item" open=""
            separator=",">
            (${userId},#{item.equipmentName},#{item.size},#{item.processParameters},#{item.amount},#{item.remark})
        </foreach>
    </insert>

  <select id="selectByUserId" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from mequipment_tbl
    where user_id=#{userId}
    <if test="equipmentName != null and equipmentName != ''">
    and equipment_name LIKE CONCAT('%', #{equipmentName},'%')
    </if>
    <if test="remark != null and remark != ''">
    and remark LIKE CONCAT('%', #{remark},'%')
    </if>
    order by id desc
  </select>
  
  <select id="selectByUserIdClique" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from mequipment_tbl
    where user_id in (${userIds})
    <if test="equipmentName != null and equipmentName != ''">
    and equipment_name LIKE CONCAT('%', #{equipmentName},'%')
    </if>
    <if test="remark != null and remark != ''">
    and remark LIKE CONCAT('%', #{remark},'%')
    </if>
    order by id desc
  </select>
  
  <select id="selectMequipmentList" parameterType="java.util.Map" resultType="com.spring.web.ibatis.DynamicParameter">
    select
         T1.id, T1.user_id userId, T1.equipment_name equipmentName, T1.process_parameters processParameters, T1.amount, 
          T1.remark, T2.name companyName
    from mequipment_tbl T1
    left join company_view T2 on T1.user_id = T2.user_id
      <where> T2.is_del= 0
        <if test="userId != null">
            and T1.user_id = #{userId} 
        </if>
        <if test="villageId != null"> and T2.village_id = #{villageId}</if>
        <if test="townId != null"> and T2.town_id = #{townId}</if>
        <if test="districtId != null"> and T2.district_id = #{districtId}</if>
        <if test="seName != null and seName != ''">
              and T1.se_name LIKE CONCAT('%', #{seName},'%')
         </if>
        <if test="companyName != null and companyName != ''">
           and T2.name LIKE CONCAT('%', #{companyName},'%')
        </if>
      </where>
         order by T1.id desc
    </select>

</mapper>